{% extends "rrdviewer/base.html" %}
{% block content %}
        <script>
            function update_chart(chart, selector, url){
                var jqxhr = $.getJSON( url, function(data) {
                    d3.select(selector)
	                .datum(data)
        	        .transition().duration(500)
	                .call(chart).style({ 'width': 400, 'height': 200 });

        	    }).always(function() {
	                setTimeout(function(){
	                    update_chart(chart, selector, url);
        	        }, 30000);
	            });
            }
        </script>
{% for graph in graphs %}

<h3>{{ graph.name }}</h3>
<div class="row">
    <div class="col-md-6">{{ graph.name }}</div>
    <div class="col-md-6">
        <div id="{{graph.graph_id}}_hourly">
            <svg height="300px"></svg>
        </div>
    </div>
</div>


<script>
    nv.addGraph(function() {
        var chart = nv.models.stackedAreaChart()
            .x(function(d) { return d[0] })
            .y(function(d) { return d[1] })
            .clipEdge(true)
            .useInteractiveGuideline(true)
            ;

        chart.xAxis
            .showMaxMin(false)
            .tickFormat(function(d) { return d3.time.format('%X')(new Date(d)) });

        chart.yAxis
            .tickFormat(d3.format(',.2f'));

        nv.utils.windowResize(chart.update);

        update_chart(chart, "#{{graph.graph_id}}_hourly svg", "{{ graph.hourly_rrd_url }}" );

    });
</script>


{% endfor %}
{% endblock %}
